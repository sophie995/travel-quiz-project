<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸¬æ¸¬ä½ çš„æ—…è¡Œé¢¨æ ¼ï¼šç†æƒ³æ—…ä¼´æ¸¬é©— | å»è¶£æ—…è¡Œ</title>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+Antique:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* CSS è®Šæ•¸å®šç¾©ï¼šä½¿ç”¨æŒ‡å®šçš„é…è‰² */
        :root {
            --primary-blue: #00AEDC; /* ä¸»è‰²ï¼šæ·±é’è‰² (#00AEDC) */
            --accent-yellow: #F9BE00; /* å¼·èª¿è‰²ï¼šäº®é»ƒè‰² (#F9BE00) */
            --text-dark: #1C1C1C;
            --bg-light: #FAFAFA;
            --font-main: 'Zen Kaku Gothic Antique', 'Microsoft YaHei', sans-serif;
        }

        /* å…¨åŸŸæ¨£å¼ */
        body {
            font-family: var(--font-main);
            background-color: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 700px;
            background-color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin: 20px 0;
            border-radius: 12px;
        }

        /* é é¦–èˆ‡ LOGO */
        header {
            width: 100%;
            padding: 20px 0;
            text-align: center;
            background-color: var(--primary-blue);
            color: white;
            margin-bottom: 20px;
        }

        h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        h2 {
            font-size: 18px;
            font-weight: 400;
            opacity: 0.8;
        }
        .logo {
            font-size: 24px; 
            font-weight: 700;
            margin-bottom: 10px;
        }

        /* å…§å®¹å€å¡Š */
        .section {
            display: none; 
            padding: 20px 0;
        }
        .section.active {
            display: block;
        }

        /* é€²åº¦æ¢ */
        .progress-bar {
            height: 8px;
            background-color: #E0E0E0;
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .progress-bar-fill {
            height: 100%;
            width: 0;
            background-color: var(--accent-yellow);
            transition: width 0.3s ease-in-out;
        }

        /* æ¸¬é©—é¡Œç›®èˆ‡é¸é … */
        .question-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--text-dark);
        }

        .option {
            display: block;
            background-color: var(--bg-light);
            padding: 15px;
            margin-bottom: 10px;
            border: 2px solid #D0D0D0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .option:hover {
            border-color: var(--primary-blue);
        }

        .option.selected {
            background-color: #E8F5FF; 
            border-color: var(--accent-yellow);
            box-shadow: 0 0 5px rgba(249, 190, 0, 0.5);
        }

        /* æŒ‰éˆ• */
        .btn-next, .btn-submit {
            padding: 12px 25px;
            background-color: var(--accent-yellow);
            color: var(--text-dark);
            font-size: 18px;
            font-weight: 700;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            margin-top: 20px;
            width: 100%;
        }

        .btn-next:hover, .btn-submit:hover {
            background-color: #E6AD00;
        }

        /* çµæœå€å¡Š */
        .result-title {
            color: var(--primary-blue);
            font-size: 24px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 10px;
        }
        .result-type {
            color: var(--accent-yellow);
            font-size: 32px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 20px;
        }
        .result-description, .result-advice {
            padding: 15px;
            border-left: 5px solid var(--primary-blue);
            margin-bottom: 15px;
            background-color: var(--bg-light);
        }

        /* æŠ½çè¡¨å–®å€å¡Š */
        .prize-section {
            background-color: #E8F5FF; 
            padding: 30px;
            border-radius: 10px;
            margin-top: 30px;
        }
        .prize-title {
            font-size: 22px;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 15px;
        }
        .prize-list li {
            font-size: 16px;
            margin-bottom: 8px;
        }
        .prize-list li strong {
            color: var(--accent-yellow);
        }
        .prize-note {
            font-size: 14px;
            color: #D32F2F; 
            font-weight: 700;
            margin-top: 15px;
        }

        /* è¡¨å–®æ¨£å¼ */
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            font-weight: 700;
            margin-bottom: 5px;
        }
        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group input[type="tel"] {
            width: 95%;
            padding: 10px;
            border: 1px solid #CCC;
            border-radius: 5px;
            font-family: var(--font-main);
        }
        
        /* éš±ç§æ¬Šå‹¾é¸ */
        .privacy-check {
            font-size: 14px;
            margin-top: 20px;
        }
        .privacy-check a {
            color: var(--primary-blue);
            text-decoration: none;
            font-weight: 700;
        }
        .privacy-check input[type="checkbox"] {
            margin-right: 5px;
        }

        /* é å°¾ */
        footer {
            width: 100%;
            text-align: center;
            padding: 20px 0;
            font-size: 12px;
            color: #777;
            margin-top: 40px;
            border-top: 1px solid #EEE;
        }
        footer a {
            color: var(--primary-blue);
            margin: 0 10px;
        }
    </style>
</head>
<body>

    <header>
        <div class="logo">chicTrip å»è¶£æ—…è¡Œ</div>
        <h1>æ¸¬æ¸¬ä½ çš„æ—…è¡Œé¢¨æ ¼ï¼šä½ æ˜¯å“ªä¸€ç¨®ã€Œç†æƒ³æ—…ä¼´ã€ï¼Ÿ</h1>
        <h2>åƒ…éœ€ 3 åˆ†é˜ï¼Œ10 é¡Œæ ¸å¿ƒå•ç­”ï¼Œæ­é–‹ä½ çš„æ—…è¡Œ DNAï¼</h2>
    </header>

    <div class="container">
        <div id="quiz-section" class="section active">
            <p>æ¥ä¸‹ä¾†ï¼Œè«‹æ ¹æ“šä½ æœ€çœŸå¯¦çš„ç›´è¦ºé¸æ“‡ç­”æ¡ˆï¼Œæ²’æœ‰å°éŒ¯ä¹‹åˆ†ã€‚</p>
            <div class="progress-bar"><div id="progress-fill" class="progress-bar-fill"></div></div>
            
            <div id="question-container">
                </div>
            
            <button id="next-button" class="btn-next" disabled>ä¸‹ä¸€é¡Œ</button>
        </div>

        <div id="result-section" class="section">
            <h3 class="result-title">ã€æ¸¬é©—çµæœæ­æ›‰ï¼ã€‘</h3>
            <div id="result-type" class="result-type"></div>
            
            <div id="result-detail">
                </div>

            <div class="prize-section">
                <h3 class="prize-title">ğŸŠ æ­å–œå®Œæˆæ¸¬é©—ï¼å…è²»åƒåŠ ã€è±ªè¯æ—…è¡ŒæŠ½çæ´»å‹•ã€‘ï¼</h3>
                <p>æ„Ÿè¬æ‚¨çš„åƒèˆ‡ï¼åªè¦å®Œæˆä¸‹æ–¹è³‡è¨Šå¡«å¯«ä¸¦æäº¤ï¼Œå³å¯ç²å¾—æŠ½çè³‡æ ¼ã€‚</p>

                <ul class="prize-list">
                    <li>ğŸ† **é ­çï¼š** <strong style="color: var(--accent-yellow);">ANA æ±äº¬ä¾†å›æ©Ÿç¥¨ (å…± 3 çµ„)</strong></li>
                    <li>ğŸ **äºŒçï¼š** å»è¶£æ—…è¡Œå‘¨é‚Šå•†å“ (å…± 30 å)</li>
                    <li>âœ¨ **ä¸‰çï¼š** å’Œæ³° Points 300 é» (å…± 20 å)</li>
                </ul>

                <p class="prize-note">â€» åƒåŠ æ´»å‹•éœ€åŒæ„è¨‚é–± ANA é›»å­å ±ï¼Œä¸­çè€…å°‡ä»¥é›»å­å ±è¨‚é–±ä¿¡ç®±é€²è¡Œé€šçŸ¥ã€‚</p>

                <hr style="border-top: 1px solid #B0E0FF; margin: 20px 0;">

                <form id="lottery-form">
                    <h3 class="prize-title" style="color: var(--text-dark);">å¡«å¯«æŠ½çè¯çµ¡æ–¹å¼</h3>
                    <div class="form-group">
                        <label for="name">ä¸­æ–‡å§“å (éœ€åŒè­·ç…§):</label>
                        <input type="text" id="name" name="name" required> 
                    </div>
                    <div class="form-group">
                        <label for="email">éƒµä»¶ä¿¡ç®±:</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">è¯ç¹«é›»è©±:</label>
                        <input type="tel" id="phone" name="phone" required>
                    </div>

                    <div class="privacy-check">
                        <input type="checkbox" id="privacy-agree" required>
                        <label for="privacy-agree">æˆ‘å·²é–±è®€ä¸¦åŒæ„ <a href="#" onclick="alert('æ­¤è™•æ‡‰å½ˆå‡ºæˆ–å°å‘éš±ç§æ¬Šæ¢æ¬¾å…¨æ–‡'); return false;">éš±ç§æ¬Šæ¢æ¬¾</a>ï¼Œä¸¦åŒæ„**è¨‚é–± ANA é›»å­å ±**ä»¥å®Œæˆæ´»å‹•åƒåŠ è³‡æ ¼ã€‚</label>
                    </div>

                    <button type="submit" class="btn-submit">åŒæ„æäº¤ (å–å¾—æŠ½çè³‡æ ¼)</button>
                </form>
            </div>
        </div>

    </div>

    <footer>
        ç‰ˆæ¬Šæ‰€æœ‰ Â© 2025 å»è¶£æ—…è¡Œ.
        <a href="#">æœå‹™æ¢æ¬¾</a> | <a href="#" onclick="alert('æ­¤è™•æ‡‰å½ˆå‡ºæˆ–å°å‘éš±ç§æ¬Šæ”¿ç­–å…¨æ–‡'); return false;">éš±ç§æ¬Šæ”¿ç­–</a>
    </footer>

    <script>
        // JavaScript ç¨‹å¼ç¢¼ï¼šè¨ˆåˆ†èˆ‡æµç¨‹æ§åˆ¶

        // **é‡è¦ï¼šæ‚¨çš„ Google Apps Script éƒ¨ç½² URL (è³‡æ–™æäº¤çµ‚é»)**
        const gasScriptURL = "https://script.google.com/macros/s/AKfycbzMspphcUOWt0QqKTrJhY5pNClyfuxkpKW1Bk1nupQd32wJi8nPmfDD5Nv51H--3rbp/exec"; 

        const questions = [
            { id: 1, title: "Q1: åœ¨è¦åŠƒä¸€è¶ŸæœŸå¾…å·²ä¹…çš„æ—…ç¨‹æ™‚ï¼Œä½ æœƒï¼š", options: { A: 4, B: 1, C: 2, D: 3 }, choices: ["A. å„ªå…ˆè¨‚å¥½æœ€åˆºæ¿€ã€æœ€ç‰¹åˆ¥çš„æ´»å‹•", "B. ä»”ç´°åˆ—å‡ºæ¯æ—¥è¡Œç¨‹ã€äº¤é€šæ–¹å¼", "C. ç ”ç©¶ç•¶åœ°é«˜è©•åƒ¹çš„ç¾é£Ÿé¤å»³å’Œé…’å§", "D. æŸ¥è©¢ç•¶åœ°çš„æ­·å²æ–‡åŒ–ã€åšç‰©é¤¨"] },
            { id: 2, title: "Q2: ä½ åœ¨æ—…ç¨‹ä¸­å°ã€Œæ™‚é–“ã€çš„æŒæ¡åº¦æ˜¯ï¼š", options: { A: 4, B: 1, C: 2, D: 3 }, choices: ["A. éš¨æ€§ï¼Œé‚Šèµ°é‚Šçœ‹ï¼Œé²åˆ°ä¹Ÿæ²’é—œä¿‚", "B. åš´æ ¼ï¼Œä¸€åˆ‡æŒ‰è¡¨å®šæ™‚é–“é€²è¡Œ", "C. å¯¬é¬†ï¼Œåªè¦èƒ½åƒåˆ°é£¯ã€è²·åˆ°æ±è¥¿å°±å¥½", "D. å½ˆæ€§ï¼Œæœƒå› å¤©æ°£æˆ–æ„å¤–çš„é¢¨æ™¯è€Œèª¿æ•´"] },
            { id: 3, title: "Q3: æ—…é€”ä¸­çš„ä½å®¿åœ°é»ï¼Œä½ æœ€é‡è¦–ä»€éº¼ï¼Ÿ", options: { A: 4, B: 1, C: 2, D: 3 }, choices: ["A. æœ€å¥½æ˜¯å¸³ç¯·ã€æ°‘å®¿æˆ–ç‰¹è‰²è† å›Šæ—…é¤¨", "B. äº¤é€šä¾¿åˆ©ã€è¨­æ–½é½Šå…¨ã€æä¾› Wi-Fi", "C. æ“æœ‰ç¾éº—çš„æ³³æ± ã€å¥¢è¯çš„æµ´ç¼¸", "D. é è¿‘å¸‚ä¸­å¿ƒæˆ–æ­·å²å¤åŸå€"] },
            { id: 4, title: "Q4: ä½ çš„æ—…è²»é ç®—åˆ†é…é€šå¸¸æ˜¯ï¼š", options: { A: 4, B: 1, C: 2, D: 3 }, choices: ["A. å¤§éƒ¨åˆ†èŠ±åœ¨é«”é©—æ´»å‹•å’Œç´€å¿µå“ä¸Š", "B. ä¸»è¦èŠ±åœ¨äº¤é€šå’Œä¿éšªï¼Œç›¡é‡ç¯€çœ", "C. å¤§éƒ¨åˆ†èŠ±åœ¨ç¾é£Ÿã€è³¼ç‰©å’Œäº«å—è¨­æ–½", "D. é¡˜æ„èŠ±éŒ¢åœ¨å°éŠæˆ–æ·±åº¦éŠè¦½è¡Œç¨‹ä¸Š"] },
            { id: 5, title: "Q5: ç•¶æ—…é€”ä¸­é‡åˆ°çªç™¼ç‹€æ³ (å¦‚ï¼šèˆªç­å»¶èª¤) æ™‚ï¼Œä½ æœƒï¼š", options: { A: 4, B: 1, C: 2, D: 3 }, choices: ["A. æ„Ÿåˆ°èˆˆå¥®ï¼Œé€™æ‰æ˜¯æ—…è¡Œçš„æ¨‚è¶£æ‰€åœ¨ï¼", "B. ç«‹å³æ‰“é–‹æ‰‹æ©Ÿï¼Œå°‹æ‰¾æ‰€æœ‰å¯èƒ½çš„è§£æ±ºæ–¹æ¡ˆ", "C. å…ˆæ‰¾å€‹å’–å•¡å»³ä¼‘æ¯ï¼ŒæŠŠä¸æ„‰å¿«æ‹‹è«¸è…¦å¾Œ", "D. è¶æ©Ÿå»é™„è¿‘çœ‹çœ‹æ„å¤–çš„é¢¨æ™¯æˆ–æ™¯é»"] },
            { id: 6, title: "Q6: ä½ åœ¨æ—…è¡Œä¸­æ‹ç…§çš„é‡é»æ˜¯ï¼š", options: { A: 4, B: 1, C: 2, D: 3 }, choices: ["A. ç¨ç‰¹çš„é¢¨æ™¯æˆ–æŒ‘æˆ°æˆåŠŸçš„é‚£ä¸€åˆ»", "B. æ‰€æœ‰é‡è¦çš„åœ°æ¨™ï¼Œæ•´é½Šæ’åˆ—åœ¨ç›¸ç°¿ä¸­", "C. ç¾é£Ÿæ“ºç›¤ã€æ™‚å°šçš„ç©¿æ­ã€ç¶²ç¾æ™¯é»", "D. å…·æœ‰ç•¶åœ°ç‰¹è‰²çš„äººæ–‡è¡—æ™¯å’Œå»ºç¯‰ç´°ç¯€"] },
            { id: 7, title: "Q7: å¦‚æœä¸€å¤©ä¸­æ²’æœ‰å®‰æ’ä»»ä½•è¡Œç¨‹ï¼Œä½ æœƒï¼š", options: { A: 4, B: 1, C: 2, D: 3 }, choices: ["A. éš¨ä¾¿æ‰¾å€‹åœ°æ–¹æ¢éšªæˆ–å˜—è©¦ç•¶åœ°äº¤é€š", "B. ç„¦æ…®ä¸å®‰ï¼Œç«‹åˆ»ä¸Šç¶²æœå°‹ä¸‹ä¸€æ­¥æ€éº¼è¾¦", "C. ç¡åˆ°è‡ªç„¶é†’ï¼Œç„¶å¾Œäº«å—ä¸€é “è±ç››çš„æ—©åˆé¤", "D. æ‰¾é–“æ›¸åº—æˆ–å’–å•¡å»³ï¼Œè§€å¯Ÿç•¶åœ°äººçš„ç”Ÿæ´»"] },
            { id: 8, title: "Q8: é—œæ–¼è¡Œç¨‹ä¸­çš„ã€Œé¤é£²ã€ï¼Œä½ çš„æ…‹åº¦æ˜¯ï¼š", options: { A: 4, B: 1, C: 2, D: 3 }, choices: ["A. åƒç•¶åœ°äººæ¨è–¦çš„è¡—é‚Šæ”¤æˆ–ç‰¹è‰²å°åº—", "B. æ‰¾é™„è¿‘æœ€æ–¹ä¾¿ã€å¿«é€Ÿè§£æ±ºçš„ä¸€é¤", "C. å„ªå…ˆé¸æ“‡è©•åƒ¹é«˜ã€ç’°å¢ƒå¥½çš„é¤å»³æˆ–ç±³å…¶æ—", "D. å˜—è©¦ç•¶åœ°å‚³çµ±é£Ÿç‰©ï¼Œä¸¦äº†è§£å…¶è£½ä½œéç¨‹"] },
            { id: 9, title: "Q9: æ—…è¡Œå‰ï¼Œä½ æœ€å–œæ­¡çœ‹å“ªä¸€é¡å‹çš„è³‡æ–™ï¼Ÿ", options: { A: 4, B: 1, C: 2, D: 3 }, choices: ["A. æˆ¶å¤–æ¢éšª Youtuber æˆ–èƒŒåŒ…å®¢åˆ†äº«", "B. æ—…éŠé”äººçš„æ”»ç•¥ã€Excel è¡Œç¨‹è¡¨ç¯„æœ¬", "C. æ—…éŠé›œèªŒçš„é£¯åº—é–‹ç®±æˆ–è³¼ç‰©æŒ‡å—", "D. åœ‹å®¶åœ°ç†é »é“ã€æ­·å²ç´€éŒ„ç‰‡"] },
            { id: 10, title: "Q10: çµæŸä¸€å¤©çš„è¡Œç¨‹å¾Œï¼Œä½ çš„å¤œæ™šæ™‚é–“æ˜¯ï¼š", options: { A: 4, B: 1, C: 2, D: 3 }, choices: ["A. åˆ°è™•èµ°èµ°ï¼Œå°‹æ‰¾ä¸‹ä¸€å¤©çš„é©šå–œ", "B. æ•´ç†ç…§ç‰‡ã€ç¢ºèªæ˜å¤©çš„äº¤é€šæ™‚é–“", "C. äº«å—é£¯åº—è¨­æ–½ï¼Œä¾‹å¦‚æ³¡æ¾¡æˆ–å»é…’å§", "D. å¯«ä¸‹ä»Šå¤©çš„è¦‹èï¼Œæ•´ç†æ–‡åŒ–ç­†è¨˜"] }
        ];

        const results = {
            'A': { type: 'A. åˆºæ¿€çš„å†’éšªå®¶', desc: "æœªçŸ¥ã€æ‰æ˜¯ä½ æ—…è¡Œæœ€å¤§çš„æ¨‚è¶£ã€‚ä½ ä¸å–œæ­¡è¢«æ™‚é–“è¡¨æŸç¸›ï¼Œæ¯”èµ·èˆ’é©çš„é£¯åº—ï¼Œä½ æ›´æ„›å……æ»¿æ•…äº‹çš„é’æ—…æˆ–éœ²ç‡Ÿ...", advice: "çµ¦ä½ çš„å»ºè­°ï¼šè©¦è‘—åœ¨å‡ºç™¼å‰è‡³å°‘ç¢ºèªå¥½ç¬¬ä¸€æ™šçš„ä½å®¿å’ŒåŸºæœ¬çš„ä¿éšªè³‡è¨Šï¼Œè®“å†’éšªæ›´æœ‰ä¿éšœï¼" },
            'B': { type: 'B. åš´è¬¹çš„è¦åŠƒæ§', desc: "ä½ æ˜¯æ—…è¡Œåœ˜é«”ä¸­çš„éˆé­‚äººç‰©ï¼Œæ‰€æœ‰è¡Œç¨‹éƒ½å¿…é ˆåœ¨ä½ çš„ Excel è¡¨æ ¼ä¸­ï¼Œä¸€åˆ‡éƒ½åœ¨æŒæ¡ä¹‹ä¸­...", advice: "çµ¦ä½ çš„å»ºè­°ï¼šè©¦è‘—åœ¨ä½ çš„è¡Œç¨‹è¡¨ä¸Šç•™å‡ºä¸€å€‹å°æ™‚çš„ã€Œç©ºç™½æ™‚é–“ã€ï¼Œçµ¦è‡ªå·±ä¸€å€‹éš¨å¿ƒæ‰€æ¬²çš„æ©Ÿæœƒã€‚" },
            'C': { type: 'C. ç›¡æƒ…çš„äº«æ¨‚ä¸»ç¾©è€…', desc: "æ—…è¡Œå°ä½ ä¾†èªªï¼Œæ˜¯å¾æ—¥å¸¸å£“åŠ›ä¸­è§£è„«çš„æœ€å¥½æ–¹å¼ã€‚ä½ å–œæ­¡å„ªè³ªçš„ä½å®¿ã€é«˜æ°´æº–çš„ç¾é£Ÿå’Œè³¼ç‰©é«”é©—...", advice: "çµ¦ä½ çš„å»ºè­°ï¼šä¸‹æ¬¡å¯ä»¥è©¦è‘—å°‡ã€Œç¾é£Ÿã€çš„é ç®—ï¼Œåˆ†é…ä¸€éƒ¨åˆ†åˆ°ã€Œç¨ç‰¹é«”é©—ã€ä¸Šï¼Œè®“å¿«æ¨‚å»¶çºŒåˆ°å›å®¶å¾Œã€‚" },
            'D': { type: 'D. å…§æ–‚çš„æ–‡åŒ–æ¢ç´¢å®¶', desc: "ä½ æ˜¯å€‹æ·±åº¦æ—…è¡Œè€…ï¼Œæ¯”èµ·æ‰“å¡æ™¯é»ï¼Œä½ æ›´ç†±è¡·æ–¼äº†è§£ä¸€å€‹åœ°æ–¹çš„æ­·å²ã€æ–‡åŒ–å’Œç¤¾æœƒç¾ç‹€...", advice: "çµ¦ä½ çš„å»ºè­°ï¼šä¸‹æ¬¡å¯ä»¥è©¦è‘—å¤šæ‹ä¸€äº›ã€Œäººåƒç…§ã€ï¼ŒæŠŠä½ åœ¨æ—…é€”ä¸­è§€å¯Ÿåˆ°çš„ç”Ÿå‹•ç•«é¢å’Œç•¶åœ°çš„æ•…äº‹ï¼Œé€éä½ çš„é¡é ­å‚³é”çµ¦æ›´å¤šäººã€‚" }
        };

        let currentQuestionIndex = 0;
        let totalScore = 0;
        const answers = {};

        const questionContainer = document.getElementById('question-container');
        const nextButton = document.getElementById('next-button');
        const progressFill = document.getElementById('progress-fill');
        const quizSection = document.getElementById('quiz-section');
        const resultSection = document.getElementById('result-section');
        const resultTypeDiv = document.getElementById('result-type');
        const resultDetailDiv = document.getElementById('result-detail');
        const lotteryForm = document.getElementById('lottery-form');

        // æ¸²æŸ“ç•¶å‰é¡Œç›®
        function renderQuestion() {
            if (currentQuestionIndex >= questions.length) {
                showResult();
                return;
            }

            const q = questions[currentQuestionIndex];
            const qNum = currentQuestionIndex + 1;
            const optionsKeys = Object.keys(q.options);
            
            let html = `<p class="question-title">ç¬¬ ${qNum} é¡Œ / å…± ${questions.length} é¡Œ</p>`;
            html += `<p class="question-title">${q.title}</p>`;
            
            q.choices.forEach((choiceText, index) => {
                const choiceKey = optionsKeys[index]; 
                html += `<div class="option" data-score-key="${choiceKey}">${choiceText}</div>`;
            });
            
            questionContainer.innerHTML = html;
            updateProgress();
            
            // ç›£è½é¸é …é»æ“Š
            document.querySelectorAll('.option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    nextButton.disabled = false;
                    answers[q.id] = this.getAttribute('data-score-key'); 
                });
            });
            
            nextButton.disabled = true; 
        }

        // æ›´æ–°é€²åº¦æ¢
        function updateProgress() {
            const progress = (currentQuestionIndex / questions.length) * 100;
            progressFill.style.width = progress + '%';
        }

        // è¨ˆç®—åˆ†æ•¸ä¸¦é¡¯ç¤ºçµæœ
        function showResult() {
            totalScore = 0;
            questions.forEach(q => {
                const scoreKey = answers[q.id]; 
                totalScore += q.options[scoreKey]; 
            });

            // åˆ¤æ–·é¡å‹ (èˆ‡è¦æ ¼æ›¸ä¸€è‡´)
            let resultKey;
            if (totalScore >= 35) {
                resultKey = 'A'; // 35-40: å†’éšªå®¶
            } else if (totalScore >= 28) {
                resultKey = 'D'; // 28-34: æ–‡åŒ–æ¢ç´¢å®¶
            } else if (totalScore >= 20) {
                resultKey = 'C'; // 20-27: äº«æ¨‚ä¸»ç¾©è€…
            } else {
                resultKey = 'B'; // 10-19: è¦åŠƒæ§
            }
            
            const resultData = results[resultKey];

            // æ¸²æŸ“çµæœå…§å®¹
            resultTypeDiv.textContent = `ä½ æ˜¯ã€${resultData.type}ã€‘é¡å‹ï¼`;
            resultDetailDiv.innerHTML = `
                <p class="result-description"><strong>æ ¸å¿ƒç‰¹è³ªï¼š</strong> ${resultData.desc}</p>
                <p class="result-advice"><strong>è¡Œå‹•å»ºè­°ï¼š</strong> ${resultData.advice}</p>
                <button style="margin: 10px 0; background-color: ${getComputedStyle(document.documentElement).getPropertyValue('--primary-blue')}; color: white;" class="btn-next" onclick="alert('åˆ†äº«åŠŸèƒ½å¾…å¯¦ä½œ');">åˆ†äº«æˆ‘çš„çµæœï¼</button>
            `;

            // åˆ‡æ›é é¢
            quizSection.classList.remove('active');
            resultSection.classList.add('active');
        }

        // ç›£è½ã€Œä¸‹ä¸€é¡Œã€æŒ‰éˆ•
        nextButton.addEventListener('click', function() {
            if (currentQuestionIndex < questions.length) {
                currentQuestionIndex++;
                renderQuestion();
            }
        });

        // ** GAS æäº¤é‚è¼¯ï¼šè™•ç†è¡¨å–®æäº¤ä¸¦ç™¼é€åˆ° Apps Script **
        lotteryForm.addEventListener('submit', function(event) {
            event.preventDefault(); 
            
            const formData = new FormData(this); 
            
            // ç¦ç”¨æŒ‰éˆ•ï¼Œé˜²æ­¢é‡è¤‡æäº¤
            const submitButton = document.querySelector('.btn-submit');
            submitButton.disabled = true;
            submitButton.textContent = 'æäº¤ä¸­...';

            // ä½¿ç”¨ Fetch API æäº¤æ•¸æ“šåˆ° Google Apps Script
            fetch(gasScriptURL, {
                method: 'POST',
                body: formData,
            })
            .then(response => response.json())
            .then(data => {
                if (data.result === 'success') {
                    // æäº¤æˆåŠŸï¼Œé¡¯ç¤ºæ„Ÿè¬è¨Šæ¯
                    const prizeSection = document.querySelector('.prize-section');
                    prizeSection.innerHTML = `
                        <h3 class="prize-title" style="color: green;">âœ… è³‡æ–™å·²æˆåŠŸæäº¤ï¼</h3>
                        <p>æ„Ÿè¬æ‚¨çš„åƒèˆ‡ï¼Œæ‚¨å·²æˆåŠŸç²å¾—æŠ½çè³‡æ ¼ã€‚è«‹éš¨æ™‚ç•™æ„æ‚¨çš„ä¿¡ç®±é€šçŸ¥ã€‚</p>
                    `;
                } else {
                    alert('æäº¤å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('æäº¤ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£æ¥ã€‚');
            })
            .finally(() => {
                // æ¢å¾©æŒ‰éˆ•ç‹€æ…‹ (å¦‚æœæäº¤æˆåŠŸï¼Œæ­¤è¡Œä¸æœƒåŸ·è¡Œï¼Œå› ç‚º prizeSection å…§å®¹å·²è¢«æ›¿æ›)
                submitButton.disabled = false;
                submitButton.textContent = 'åŒæ„æäº¤ (å–å¾—æŠ½çè³‡æ ¼)';
            });
        });

        // é¦–æ¬¡è¼‰å…¥
        renderQuestion();
    </script>

</body>
</html>
