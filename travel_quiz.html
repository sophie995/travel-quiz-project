<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—…éŠæ¸¬é©—èˆ‡æŠ½ç</title>
    <style>
        /* åŸºç¤æ¨£å¼ï¼Œè®“é é¢çœ‹èµ·ä¾†æ›´æ•´æ½” */
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f4f4; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #333; }
        .quiz-section, .form-section { margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; }
        input[type="text"], input[type="email"] { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { background-color: #007bff; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background-color: #0056b3; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸŒ æ—…éŠçŸ¥è­˜æ¸¬é©—</h1>

    <div id="quiz-container" class="quiz-section">
        <p>è«‹å›ç­”ä»¥ä¸‹å•é¡Œ...</p>
        <p>æ¸¬é©—å·²å®Œæˆï¼</p>
        <button id="show-form-btn">é€²å…¥æŠ½çè¡¨å–®</button>
    </div>

    <div id="form-container" class="form-section hidden">
        <h2>ğŸ‰ æ­å–œå®Œæˆæ¸¬é©—ï¼</h2>
        <p>æ„Ÿè¬æ‚¨çš„åƒèˆ‡ï¼åªè¦å®Œæˆä¸‹æ–¹è³‡è¨Šå¡«å¯«ä¸¦æäº¤ï¼Œå³å¯ç²å¾—æŠ½çè³‡æ ¼ã€‚</p>

        <form id="lottery-form">
            <label for="name">ä¸­æ–‡å§“å (éœ€åŒè­·ç…§)</label>
            <input type="text" id="name" name="name" required>

            <label for="email">é›»å­éƒµä»¶ (Email)</label>
            <input type="email" id="email" name="email" required>
            
            <label for="phone">è¯çµ¡é›»è©±</label>
            <input type="text" id="phone" name="phone" required>

            <p style="font-size: 0.8em; color: #666;">*æˆ‘å·²é–±è®€ä¸¦åŒæ„ç›¸é—œéš±ç§æ”¿ç­–ã€‚</p>
            <button type="submit">åŒæ„ä¸¦æäº¤è³‡æ–™</button>
            <p id="message-area" style="margin-top: 10px; color: red;"></p>
        </form>
    </div>
</div>

<script>
    // ************************************************
    // ** âœ… Apps Script Web App URL å·²æˆåŠŸåµŒå…¥ **
    // ************************************************
    const APP_SCRIPT_URL = "https://script.google.com/macros/s/AKfycby2wuZ4cUXTZDLCUEgSpQ8WKO1SuKTvrTEBRnWSyqGwI63TsmIfFqYzmtWybWRXKUKf4A/exec";

    const formContainer = document.getElementById('form-container');
    const quizContainer = document.getElementById('quiz-container');
    const showFormBtn = document.getElementById('show-form-btn');
    const lotteryForm = document.getElementById('lottery-form');
    const messageArea = document.getElementById('message-area');

    showFormBtn.addEventListener('click', () => {
        quizContainer.classList.add('hidden');
        formContainer.classList.remove('hidden');
    });

    lotteryForm.addEventListener('submit', function(e) {
        e.preventDefault(); // é˜»æ­¢è¡¨å–®é è¨­æäº¤è¡Œç‚º
        
        messageArea.textContent = "è³‡æ–™æäº¤ä¸­ï¼Œè«‹ç¨å€™...";
        
        // æ”¶é›†è¡¨å–®æ•¸æ“š
        const formData = {
            name: document.getElementById('name').value,
            email: document.getElementById('email').value,
            phone: document.getElementById('phone').value,
        };

        // æäº¤æ•¸æ“šåˆ° Apps Script
        fetch(APP_SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify(formData), // å‚³è¼¸ JSON æ ¼å¼ï¼Œé€™æ˜¯ Apps Script doPost é æœŸçš„æ–¹å¼
            headers: {
                'Content-Type': 'application/json' 
            }
        })
        .then(response => {
            if (!response.ok) {
                // å¦‚æœæ˜¯ 404, 500 ç­‰éŒ¯èª¤ï¼Œæœƒç›´æ¥æ‹‹å‡º
                throw new Error('HTTP éŒ¯èª¤ï¼Œç‹€æ…‹ç¢¼: ' + response.status);
            }
            return response.json(); // å°‡å›å‚³å…§å®¹è§£æç‚º JSON
        })
        .then(data => {
            // è™•ç† Apps Script æˆåŠŸå›å‚³çš„ JSON çµæ§‹ (result: success æˆ– error)
            if (data.result === 'success') {
                messageArea.style.color = 'green';
                messageArea.textContent = "âœ… è³‡æ–™å·²æˆåŠŸæäº¤ï¼æ„Ÿè¬æ‚¨çš„åƒèˆ‡ï¼";
                lotteryForm.reset(); 
                
            } else {
                // é€™æ˜¯ Apps Script è…³æœ¬å…§éƒ¨æ‹‹å‡ºçš„éŒ¯èª¤ (ä¾‹å¦‚: æ‰¾ä¸åˆ°å·¥ä½œè¡¨)
                messageArea.style.color = 'red';
                messageArea.textContent = `âŒ æäº¤å¤±æ•— (ä¼ºæœå™¨éŒ¯èª¤): ${data.message}`;
            }
        })
        .catch(error => {
            // ç¶²è·¯å±¤ç´šæˆ– JSON è§£æå¤±æ•— (å¸¸è¦‹æ–¼ Apps Script æˆæ¬Š/éƒ¨ç½²éŒ¯èª¤)
            messageArea.style.color = 'red';
            console.error('Fetch éŒ¯èª¤:', error);
            messageArea.textContent = "âŒ æäº¤ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹æª¢æŸ¥ Web App éƒ¨ç½²ç‹€æ…‹èˆ‡æ¬Šé™ã€‚";
        });
    });

</script>

</body>
</html>
